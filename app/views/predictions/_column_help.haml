/
  app/views/predictions/_fx_past_column_help.haml

:javascript
  $(document).ready(function() {
    $("div#help4_currencypair").hide();
    $("div#help4_avgdanbotscore").hide();
    $("div#help4_sharperatio").hide();
    $("div#help4_avgofnormalized1hrgains").hide();
    $("div#help4_avgofnormalized5hrgains").hide();
    $("div#help4_countofpositions").hide();
    $("div#help4_sumofnormalized5hrgains").hide();
    $("div#help4_minofnormalized5hrgains").hide();
    $("div#help4_maxofnormalized5hrgains").hide();
    $("div#help4_standarddeviationofnormalized5hrgains").hide();
    $("div#help4_gmttimeathour0").hide();
    $("div#help4_danbotscoreathour0").hide();
    $("div#help4_priceathour0").hide();
    $("div#help4_1dayrunningcorrelationbetweendanbotscoreand6hrgain").hide();
    $("div#help4_priceafter1hour").hide();
    $("div#help4_normalized1hrgain").hide();
    $("div#help4_priceafter6hours").hide();
    $("div#help4_5hourgainbetweenhr1andhr6").hide();
    $("div#help4_normalized5hrgain").hide();


    $("a.currencypair").click(function(event){
      $("div#help4_currencypair").dialog({ minWidth: 300 });
    });

    $("a.avgdanbotscore").click(function(event){
      $("div#help4_avgdanbotscore").dialog({ minWidth: 550 });
    });

    $("a.sharperatio").click(function(event){
      $("div#help4_sharperatio").dialog({ minWidth: 550 });
    });

    $("a.avgofnormalized1hrgains").click(function(event){
      $("div#help4_avgofnormalized1hrgains").dialog({ minWidth: 300 });
    });

    $("a.avgofnormalized5hrgains").click(function(event){
      $("div#help4_avgofnormalized5hrgains").dialog({ minWidth: 300 });
    });

    $("a.countofpositions").click(function(event){
      $("div#help4_countofpositions").dialog({ minWidth: 300 });
    });

    $("a.sumofnormalized5hrgains").click(function(event){
      $("div#help4_sumofnormalized5hrgains").dialog({ minWidth: 300 });
    });

    $("a.minofnormalized5hrgains").click(function(event){
      $("div#help4_minofnormalized5hrgains").dialog({ minWidth: 300 });
    });

    $("a.maxofnormalized5hrgains").click(function(event){
      $("div#help4_maxofnormalized5hrgains").dialog({ minWidth: 300 });
    });

    $("a.standarddeviationofnormalized5hrgains").click(function(event){
      $("div#help4_standarddeviationofnormalized5hrgains").dialog({ minWidth: 300 });
    });



    $("a.gmttimeathour0").click(function(event){
      $("div#help4_gmttimeathour0").dialog({ minWidth: 300 });
    });

    $("a.danbotscoreathour0").click(function(event){
      $("div#help4_danbotscoreathour0").dialog({ minWidth: 550 });
    });

    $("a.priceathour0").click(function(event){
      $("div#help4_priceathour0").dialog({ minWidth: 300 });
    });

    $("a.priceafter1hour").click(function(event){
      $("div#help4_priceafter1hour").dialog({ minWidth: 300 });
    });

    $("a.normalized1hrgain").click(function(event){
      $("div#help4_normalized1hrgain").dialog({ minWidth: 300 });
    });

    $("a.priceafter6hours").click(function(event){
      $("div#help4_priceafter6hours").dialog({ minWidth: 300 });
    });

    $("a.5hourgainbetweenhr1andhr6").click(function(event){
      $("div#help4_5hourgainbetweenhr1andhr6").dialog({ minWidth: 300 });
    });

    $("a.normalized5hrgain").click(function(event){
      $("div#help4_normalized5hrgain").dialog({ minWidth: 300 });
    });

    $("a.1dayrunningcorrelationbetweendanbotscoreand6hrgain").click(function(event){
      $("div#help4_1dayrunningcorrelationbetweendanbotscoreand6hrgain").dialog({ minWidth: 300 });
    });

  });

#help4_currencypair(title="Currency-pair")
  Currency-pairs have names like EUR/USD.
  %br/
  %br/
  The name on the left is the currency getting bought.
  The name on the right is the currency I use to pay for the currency on the left.
  %br/
  %br/
  So, if I buy the EUR/USD pair, I am buying EUR with USD.
  %br/
  %br/
  If I sell the EUR/USD pair, I am selling EUR and receiving USD.
  By convention, some pairs are rarely referred to.
  For example, the EUR/USD pair is often mentioned in the media, but the USD/EUR pair is not.

#help4_avgdanbotscore(title="Avg DanBot Score")
  =render :partial => "fx_column_help_danbot"

#help4_sharperatio(title="Sharpe Ratio")
  I use the Sharpe Ratio to help me measure the past effectiveness of the DanBot.
  %br/
  %br/
  First I compare the sign of the Sharpe Ratio to the sign of Avg DanBot Score.
  %br/
  %br/
  If the signs match, that indicates to me that DanBot was probably effective.
  If the signs don't match that is definitely bad; the DanBot was issuing "false positive" predictions.
  %br/
  %br/
  For example if I see that Avg DanBot Score for AUD/JPY is -0.65,
  I want to see a Sharpe Ratio of -1.0 or less.  
  %br/
  %br/
  That means that the DanBot predictions were "true positive" and thus lucrative had I followed them.
  %br/
  %br/
  If the Sharpe Ratio is between -0.4 and 0.0, 
  that is not great but I was not losing money either.
  %br/
  %br/
  I calculate the Sharpe Ratio by taking the Avg of Normalized 5hr Gains and dividing it by Standard Deviation of Normalized 5hr Gains.
  %br/
  %br/
  Wikipedia has an article about the Sharpe Ratio:
  %a(target="w" href="http://en.wikipedia.org/wiki/Sharpe_ratio")http://en.wikipedia.org/wiki/Sharpe_ratio
  %br/
  %br/
  For some, the article is a bit dense but the idea is simple.
  %br/
  %br/
  Simply put,
  If I am earning small gains from a currency-pair which has large price fluctuations, that is a bad situation.
  As the situation grows worse, the Sharpe Ratio moves toward zero.
  %br/
  %br/
  Since the Sharpe Ratio can be viewed as a fraction, I see two ways it can move towards zero.
  The numerator of the fraction is the average gain and if that number is zero, then the Sharpe Ratio is zero.
  %br/
  %br/
  The denominator of the fraction is the standard deviation of the gains.
  If the gains wildly fluctuate, the standard deviation grows large and the Sharpe Ratio moves toward zero.
  %br/
  %br/
  I describe a simple example below using EUR/USD.
  %br/
  %br/
  Suppose during week one I do only 2 EUR/USD trades and earn gains of $10 and $30.
  The average gain for that week is $20 and the standard deviation for those 2 trades is about 14.1
  %br/
  %br/
  During week two I do another 2 EUR/USD trades and earn gains of -$20 and $60 and again the average for that week is $20.
  %br/
  %br/
  Obviously -$20 and +$60 are spread farther apart then $10 and $30 so when I calculate the standard deviation for the second 2 trades, I expect to see a larger number.  And I do; it is about 56.6
  %br/
  %br/
  Although the average gains match, I would argue that the "quality" of the gains from week one are better because
  I endured less heartburn than during week two.
  %br/
  %br/
  This heartburn cost is quantified by the Sharpe Ratio.
  The Sharpe Ratio for week two is closer to zero than the Sharpe Ratio for week one.
  %br/
  %br/
  To calculate the Sharpe Ratio I divide the average by the standard deviation.
  For week one the Sharpe Ratio is 20 / 14.1 and for week two the Sharpe Ratio is 20 / 56.6
  %hr/
  %a(target="w" href="http://www.wolframalpha.com/input/?i=standard+deviation+of+10%2C30")Standard Deviation of(10,30)
  %br/
  %a(target="w" href="http://www.wolframalpha.com/input/?i=standard+deviation+of+-20%2C60")Standard Deviation of(-20,60)

#help4_avgofnormalized1hrgains(title="Avg of normalized 1hr gains")
  When the DanBot issues a prediction-score for a pair, I conceptualize a 6 hour duration.
  %br/
  %br/
  The boundry at the beginning of the duration is a timestamp I call "Hour 0".
  %br/
  %br/
  One hour after Hour 0 is Hour 1.
  %br/
  %br/
  Six hours after Hour 0 is Hour 6.
  %br/
  %br/
  I collect prices at Hour 0, Hour 1, and Hour 6.
  %br/
  %br/
  I calculate 2 price gains, the gain between Hour 0 and Hour 1, and the gain between Hour 1 and Hour 6.
  %br/
  %br/
  For each score, I calculate the average-normalized gain between Hour 0 and Hour 1.
  %br/
  %br/
  That gain is displayed in the column, "Avg of normalized 1hr gains".
  %br/
  %br/
  When I am trading currency-pairs, I want to see two pieces of information before I decide to open a position.
  %br/
  %br/
  I want to see the DanBot score, and I want to see the normalized 1 hr gain.
  %br/
  %br/
  If the score is less than -0.55 and the normalized 1 hr gain is greater than -0.0010,
  then I will open a short position in that currency-pair.
  %br/
  %br/
  For long positions, if the score is greater than +0.55 and the normalized 1 hr gain gain is less than +0.0010,
  then I will open a long position in that currency-pair.
  %br/


#help4_avgofnormalized5hrgains(title="Avg of normalized 5hr gains")
  This column displays the average of normalized gains between Hour 1 and Hour 6.
  %br/
  %br/
  Each time I open a currency-pair-position,
  I look at the DanBot score issued at Hour 0.
  Then I wait until I can calculate the normalized 1 hour gain (which I can usually do in my head).
  %br/
  %br/
  Then I open the position at Hour 1, 
  I hold it for 5 hours, and then I close it at Hour 6 (using a clock controlled order in my brokerage account).
  %br/
  %br/
  Like the Sharpe Ratio, I use the results in this column to measure the past effectiveness of the DanBot.
  %br/
  %br/
  I place this column near the Sharpe Ratio column because I consider it almost equally indicative.
  %br/
  %br/
  The first measure of DanBot effectiveness is,
  "Do the signs of the Avg DanBot Score match the signs of the Avg of normalized 5hr gains?".  
  %br/
  %br/
  I want the signs to match;
  that means that the DanBot is at least correctly predicting the direction of the price move.
  %br/
  %br/
  If the signs do match, I next look at the magnitude of the Avg of normalized 5hr gains.
  %br/
  %br/
  Generally any gain which is greater than 0.0020 will make me happy.
  Roughly this is equivalent to a gain of $20 on a position size equivalent to $10,000.
  %br/
  %br/
  Keep in mind that a forex position size of $10,000 is too small to be allowed to trade.
  A minimum tradeable position is usually around $20,000 or $30,000.
  %br/
  %br/
  If I don't have $20,000 in my bankroll, some brokers will gladly lend it to me
  if I have 2.5% of that amount in my brokerage account.
  %br/
  %br/
  This 2.5% is referred to as "Margin".
  %br/
  %br/
  So, 2.5% of $20,000 is $500.
  %br/
  %br/
  Now suppose I use $500 of my money to open a position worth $20,000 for 5 hours
  and then I close it and I make a normalized gain of 0.0020.
  %br/
  %br/
  That would be a gain of $40.
  Of that $40, the broker will want about $2.5 commission to both enter and exit the position.
  %br/
  %br/
  So, then I'd have a gain $35.  One way to save money on commissions is to trade larger positions.
  %br/
  %br/
  The commission on a $100,000 position (which would require about $2,500 in margin)
  is roughly equivalent to the commission on a $20,000 position.
  %br/
  %br/
  So, supposing I wager $500 in margin to open a $20,000 position and then gain $35, what would be my percentage gain?
  %br/
  %br/
  It would be 100 x 35 / 500 which is 7% which is a very large gain for a position held for only 5 hours.
  %br/
  %br/

#help4_countofpositions(title="Count of Positions")
  Every hour the Forex market is open, the DanBot calculates 660 prediction scores which is almost 16,000 scores per day.
  %br/
  %br/
  The values in this column indicate how many times during a week
  that the DanBot made predictions with a high degree of confidence.
  %br/
  %br/
  I measure confidence on a scale from -1 to +1.
  %br/
  %br/
  Any score less than -0.55 or greater than +0.55 is worthy of my attention
  and thus will increment the counts in this column.
  %br/
  %br/

#help4_sumofnormalized5hrgains(title="Sum of Normalized 5hr Gains")
  The values in this column are calculated from the product of two other columns:
  %ul
    %li Avg of normalized 5hr gains
    %li Count of Positions
  I use the values here to measure the past effectiveness of the DanBot.
  %br/
  %br/
  If the DanBot issued many predictions, because it was confident, and if those predictions were accurate,
  then that effectiveness will appear here and in the total sum at the bottom of the table.
  %br/
  %br/

#help4_minofnormalized5hrgains(title="Min of Normalized 5hr Gains")
  I use the values in this column for two purposes.
  %br/
  %br/
  First, if the DanBot was effective and if it issued negative scores, then I should see large negative numbers
  in this column.
  %br/
  %br/
  Secondly, if the DanBot was effective and if it issued negative scores, the values in this column should
  give me a sense of "best-case-scenario" when I'm holding a position in real-time which I opened due to
  a large negative score which had captured my attention.
  %br/
  %br/
  If I am holding a lucrative position which has exceeded a "best-case-scenario" before the 5 hour holding period
  has expired, I might want to close the position early to lock-in a large gain.
  %br/
  %br/
  Conversely,  if the DanBot was effective and if it issued positive scores,
  then I should see small negative numbers in this column.
  %br/
  %br/

#help4_maxofnormalized5hrgains(title="Max of Normalized 5hr Gains")
  The logic behind the values in this column is similar to the logic explained here:
  %a.minofnormalized5hrgains(href="#") Min of Normalized 5hr Gains
  %br/

#help4_standarddeviationofnormalized5hrgains(title="Standard Deviation of Normalized 5hr Gains")
  I use the values in this column to gain a sense of how "jumpy" the prices of a currency-pair were 
  during the week in question (over a typical 5 hour period).
  %br/
  %br/
  Note that the values in this column (and some other columns) are for "normalized gains".
  %br/
  %br/
  A gain is typically measured as price2 - price1.
  %br/
  %br/
  This works well if the prices are roughly the same magnitude.
  %br/
  %br/
  In the Forex market though, prices for some pairs are of greater magnitude than of other pairs.
  %br/
  %br/
  For example, the price of the USD/JPY pair is usually between 70 and 90.
  %br/
  %br/
  The price of the EUR/USD pair is usually between 1.2 and 1.8.
  %br/
  %br/
  So when I do a calculation which involves a gain, I prefer to use "normalized gains".
  %br/
  %br/
  I calculate a normalized gain like this: (price2 - price1)/price1
  %br/
  %br/

#help4_gmttimeathour0(title="GMT / UTC Time at Hour 0")
  This column contains GMT/UTC timestamps for each prediction-score.
  %br/
  %br/
  During winter, GMT is 5 hours ahead of EST, 8 hours ahead of PST, and 8 hours behind JST.
  %br/
  %br/
  During summer, GMT is 4 hours ahead of EDT, 7 hours ahead of PDT, 1 hour behind BST, and 8 hours behind JST.
  %br/
  %br/
  The current GMT/UTC time can be seen here:
  %a(target="t" href="http://tycho.usno.navy.mil/cgi-bin/timer.pl")http://tycho.usno.navy.mil/cgi-bin/timer.pl
  %br/
  %br/
  During the winter, the current time in London is identical to GMT/UTC time:
  %a(target="g" href="http://www.google.com/search?q=current+time+in+London")
    http://www.google.com/search?q=current+time+in+London
  %br/
  %br/

#help4_danbotscoreathour0(title="DanBot Score")
  =render :partial => "fx_column_help_danbot"

#help4_priceathour0(title="Price at Hour 0")
  Every five minutes, for each of the 11 currency-pairs, I feed the DanBot two pieces of information.
  %br/
  %br/
  I tell it the price of the pair and I tell DanBot what time it is (GMT time).
  I refer to the price as the "Price at Hour 0".
  %br/
  %br/
  If the DanBot calculates a prediction-score that I like (below -0.55 or above +0.55) I wait for 1 hour.
  %br/
  %br/
  Then I decide to either ignore the prediction
  (usually because the of a large price-move move in the last hour),
  or I follow the prediction and open a position in the currency-pair.
  %br/
  %br/
  Then I close the position 5 hours later (using a clock controlled order in my brokerage account).
  %br/
  %br/
  I consider a price-move large (during a 1 hour period)
  if its normalized gain is below -0.0010 or above +0.0010 (which is a move of about 0.1%).
  %br/
  %br/


#help4_1dayrunningcorrelationbetweendanbotscoreand6hrgain(title="Recent Corr-tween Scores and Gains")
  When I see a DanBot-score for a pair,
  usually I want to know the recent accuracy (over the past day) of DanBot for that pair.
  The accuracy measure I use is Pearson correlation coefficent:
  %a(target="w" href="http://en.wikipedia.org/wiki/Correlation")http://en.wikipedia.org/wiki/Correlation
  %br/
  %br/
  Specifically I measure the correlation between all scores (almost 290 scores)
  and all gains for the currency-pair over the past 24 hours which the Forex market had been open.
  %br/
  %br/
  If I see a correlation greater than 0.10, I'm happy.
  If the correlation is between 0.0 and 0.05, that is similar to flipping a coin to make predictions.
  If the correlation is less than 0, that means the DanBot had been issuing "false-positive" predictions
  which were money losing predictions had I followed them.
  %br/
  %br/
  I've used back-tests to confirm that that this correlation-based-measurement changes relatively slowly.
  So I only display pairs which have a measurement greater than 0.10.
  %br/

#help4_priceafter1hour(title="Price After 1 Hour")
  If the DanBot calculates a prediction-score that I like (below -0.55 or above +0.55) I wait for 1 hour.
  %br/
  %br/
  The price for the pair at that time is displayed here.
  %br/
  %br/
  If the values here are blank either we are not at Hour 1 yet
  or my price-data-feed has crashed
  or the WebBot which transfers data from the DanServers to this website has crashed.
  %br/

#help4_normalized1hrgain(title="Normalized 1 Hour Gain")
  After the DanBot issues a prediction-score for a pair, I wait 1 hour.
  %br/
  %br/
  I call this point in time, "Hour 1".
  %br/
  %br/
  Then, I look at the change in the price of the pair during that 1 hour.
  %br/
  %br/
  Next, I divide that price-change by the price at Hour 0.
  %br/
  %br/
  I call this ratio the "Normalized 1 Hour Gain".
  %br/
  %br/
  If this ratio is greater than -0.0010,
  and if the DanBot-score is less than -0.55,
  then I will open a short-position in the corresponding pair for 5 hours and then close it.
  %br/
  %br/
  I refer to that moment in time as "Hour 6" because it is exactly 6 hours after the DanBot had calculated the score for that position.
  %br/
  %br/
  If this ratio is less than +0.0010,
  and if the DanBot-score is greater than +0.55,
  then I will open a long-position in the corresponding pair for 5 hours and then close it at Hour 6.
  %br/
  %br/
  Typically I rely on clock controlled orders in my brokerage account to close a position at Hour 6.
  %br/
  %br/
  When I open a position in a currency pair, I usually do that manually at the keyboard.
  %br/
  %br/
  Usually I act by calculating the Normalized 1 Hour Gain ratio in my head 
  at exactly Hour 1 using the price displayed by my brokerage UI.
  I dont rely on this website to calculate and then display the ratio for me.
  %br/
  %br/
  Another way I often operate is to completely ignore the Normalized 1 Hour Gain ratio.
  I act based solely on the value of the DanBot-score.
  %br/
  %br/
  In that situation I just look for a DanBot-score issued within the past hour.
  Then I look at the price of the corresponding pair in my brokerage UI.
  %br/
  %br/
  If the price has not changed much or if it is favorable compared to the price at Hour 0,
  I then open a position in the pair until exactly Hour 6 and then close it using a clock controlled order.
  %br/
  %br/
  This second way of reacting to DanBot-score is less disciplined than the first
  but I have validated that it is an effective way to trade using back-testing.
  %br/
  %br/

#help4_priceafter6hours(title="Price At Hour 6")
  This is the price of the currency-pair 6 hours after the DanBot-score was calculated.
  %br/
  %br/
  If the values here are blank either we are not at Hour 6 yet
  or my price-data-feed has crashed
  or the WebBot which transfers data from the DanServers to this website has crashed.
  %br/
  %br/

#help4_5hourgainbetweenhr1andhr6(title="5 Hour Gain Between Hour 1 and Hour 6")
  Typically I open a position at Hour 1 and close it at Hour 6 which is a 5 hour duration.
  %br/
  %br/
  The change in price of the currency-pair over that 5 hour duration is displayed here.
  %br/
  %br/

#help4_normalized5hrgain(title="Normalized 5 Hour Gain Between Hour 1 and Hour 6")
  Typically I open a position at Hour 1 and close it at Hour 6 which is a 5 hour duration.
  %br/
  %br/
  Over that 5 hour duration, 
  the change in price of the currency-pair divided by the price at Hour 0 is displayed here.
  %br/
  %br/
  Suppose I open a short-position in AUD/JPY (due to a DanBot score of -0.74 I noticed).
  %br/
  %br/
  I open the position at Hour 1 at a price of 86.3473.
  %br/
  %br/
  I wait 5 hours and close the position at Hour 6 at a price of 85.9327.
  %br/
  %br/
  The 5 hour gain would then be: -0.4146
  %br/
  %br/
  The normalized 5 hour gain would be about - 0.41 / 86 which is about -0.0048.
  %br/
  %br/
  This gain would be less lucrative than a short-position in EUR/USD which had a price move of 
  1.4313 to 1.4225.
  %br/
  %br/
  The normalized 5 hour gain for the EUR/USD position is about:
  %br/
  %br/
  (1.4225 - 1.4313) / 1.43 which is about -0.0060.
  %br/
  %br/
  So, the normalized gain of the short-position in AUD/JPY is about -0.0048.
  %br/
  %br/
  And the normalized gain of the short-position in EUR/USD is about -0.0060.
  %br/
  %br/
  Clearly the short-position in EUR/USD is more lucrative than the short-position in AUD/JPY.
  %br/
  %br/
  If I have a normalized gain of 0.0060, how much money is that?
  %br/
  %br/
  The calculation is simple, just multiply 0.0060 times the size of the position.
  %br/
  %br/
  The smallest position I can trade is about $20,000.
  %br/
  %br/
  So, 0.0060 x $20,000 is $120.
  %br/
  %br/
  When I make Forex trades I usually finance them using borrowed money from my broker called "Margin".
  %br/
  %br/
  My broker will extend me a loan up to 97.5% of the position to open the position.
  I need to supply my own money to make-up the remaining 2.5% of the position.
  %br/
  %br/
  So, to earn that $120, I need to supply $500 of my own cash.
  %br/
  %br/
  If I earn $120 from an investment of $500 that is a rate of return of 100 x 120 / 500 is 24%.
  %br/
  %br/
  I do, however, need to pay 2 brokerage commissions to open and then close the postion which is about $5.
  So, that knocks the rate of return down to 100 x 115 / 500 is 23%
  %br/
  %br/
  A little algebra reveals that the rate of return is about 4000 x normalized 5 hour gain.
  %br/
  %br/
  After doing many Forex trades, I've just memorized the fact that a normalized 5 hour gain of 0.0010
  is about the same as a 4% gain on my 2.5% margin, which is a decent gain for an asset held only 5 hours.
  %br/
  %br/



/
  %a.currencypair(href="#") Currency Pair 

